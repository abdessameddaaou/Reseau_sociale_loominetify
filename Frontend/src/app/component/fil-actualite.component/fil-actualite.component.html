<div class="min-h-screen bg-[#f5f7fa] flex flex-col">
  <!-- Top Bar -->
  <header class="bg-white shadow-sm">
    <div class="max-w-6xl mx-auto flex items-center justify-between px-6 py-3">
      <div class="flex items-center gap-4">
        <span class="text-xl font-semibold text-[#5b7cff] lowercase">loominetfy</span>
        <div class="hidden md:flex items-center bg-slate-100 rounded-full px-4 py-2 text-sm">
          <!-- <span class="material-icons text-slate-400 text-base mr-1">search</span> -->
<span class="icon-[mdi--magnify] inline-block align-middle text-slate-400 text-base mr-1"></span>

          <input
            type="text"
            placeholder="Rechercher sur loominetfy"
            class="bg-transparent outline-none text-slate-600 w-64"
          />
        </div>
      </div>

      <nav class="flex items-center gap-5 text-sm">
        <button
          class="flex items-center gap-1"
          [ngClass]="activeTab === 'home' ? 'text-[#5b7cff] font-semibold' : 'text-slate-500'"
          (click)="setActiveTab('home')"
        >
          <span class="material-icons text-base">home</span>
          <span class="hidden sm:inline">Accueil</span>
        </button>
        <button
          class="flex items-center gap-1"
          [ngClass]="activeTab === 'notifications' ? 'text-[#5b7cff] font-semibold' : 'text-slate-500'"
          (click)="setActiveTab('notifications')"
        >
          <span class="material-icons text-base">notifications</span>
          <span class="hidden sm:inline">Notifications</span>
        </button>
        <button
          class="flex items-center gap-1"
          [ngClass]="activeTab === 'messages' ? 'text-[#5b7cff] font-semibold' : 'text-slate-500'"
          (click)="setActiveTab('messages')"
        >
          <span class="material-icons text-base">chat</span>
          <span class="hidden sm:inline">Messages</span>
        </button>
        <button
          class="flex items-center gap-1"
          [ngClass]="activeTab === 'profile' ? 'text-[#5b7cff] font-semibold' : 'text-slate-500'"
          (click)="setActiveTab('profile')"
        >
          <span class="material-icons text-base">person</span>
          <span class="hidden sm:inline">Profil</span>
        </button>
        <button
          class="hidden md:flex items-center gap-1"
          [ngClass]="activeTab === 'groups' ? 'text-[#5b7cff] font-semibold' : 'text-slate-500'"
          (click)="setActiveTab('groups')"
        >
          <span class="material-icons text-base">groups</span>
          <span>Groupes</span>
        </button>
        <button
          class="hidden md:flex items-center gap-1"
          [ngClass]="activeTab === 'settings' ? 'text-[#5b7cff] font-semibold' : 'text-slate-500'"
          (click)="setActiveTab('settings')"
        >
          <span class="material-icons text-base">settings</span>
          <span>ParamÃ¨tres</span>
        </button>
      </nav>
    </div>
  </header>

  <!-- Main layout -->
  <main class="flex-1">
    <div class="max-w-6xl mx-auto flex gap-6 px-4 py-6">
      <!-- Colonne principale -->
      <section class="flex-1 space-y-4">
        <!-- Formulaire de publication -->
        <div class="bg-white rounded-2xl shadow-sm p-4">
          <div class="flex items-start gap-3 mb-3">
            <img
              src="https://i.pravatar.cc/150?img=5"
              alt="avatar"
              class="w-10 h-10 rounded-full object-cover"
            />
            <div class="flex-1">
                <textarea
                rows="2"
                placeholder="Quoi de neuf ?"
                formControlName="text"
                class="w-full resize-none border border-slate-200 rounded-2xl px-4 py-2 text-sm outline-none focus:border-[#5b7cff] focus:ring-4 focus:ring-[#5b7cff]/10"
                ></textarea>

              <div class="mt-1 text-xs text-red-600 min-h-[1rem]">
                {{ formErrors['text'] }}
              </div>
            </div>
          </div>

          <div
            *ngIf="imagePreview"
            class="ml-12 mb-3 rounded-2xl overflow-hidden border border-slate-200 max-h-72"
          >
            <img [src]="imagePreview" alt="preview" class="w-full object-cover" />
          </div>

          <div class="flex items-center justify-between mt-2">
            <div class="flex items-center gap-3 ml-12 text-xs text-slate-500">
              <label
                class="flex items-center gap-1 px-3 py-1 rounded-full hover:bg-slate-100 cursor-pointer"
              >
                <span class="material-icons text-base">image</span>
                <span>Photo</span>
                <input type="file" class="hidden" (change)="onFileSelected($event)" />
              </label>
              <span class="text-[11px] text-red-600 min-h-[1rem]">
                {{ formErrors['image'] }}
              </span>
            </div>

            <button
              class="px-5 py-2 rounded-full bg-gradient-to-r from-[#5b7cff] to-[#8b5cf6] text-white text-sm font-semibold shadow-sm hover:shadow-md hover:-translate-y-[1px] transition"
              (click)="publishPost()"
            >
              Publier
            </button>
          </div>
        </div>

        <!-- Skeleton de chargement -->
        <ng-container *ngIf="isInitialLoading">
          <div *ngFor="let s of [1,2,3]" class="bg-white rounded-2xl shadow-sm p-4 animate-pulse">
            <div class="flex items-center gap-3 mb-3">
              <div class="w-10 h-10 bg-slate-200 rounded-full"></div>
              <div class="flex-1 space-y-2">
                <div class="w-32 h-3 bg-slate-200 rounded"></div>
                <div class="w-20 h-3 bg-slate-100 rounded"></div>
              </div>
            </div>
            <div class="w-full h-3 bg-slate-200 rounded mb-2"></div>
            <div class="w-2/3 h-3 bg-slate-100 rounded mb-3"></div>
            <div class="w-full h-40 bg-slate-200 rounded-2xl"></div>
          </div>
        </ng-container>

        <!-- Etat aucun contenu -->
        <div
          *ngIf="!isInitialLoading && visiblePosts.length === 0"
          class="bg-white rounded-2xl shadow-sm p-8 text-center text-sm text-slate-500"
        >
          Aucun contenu pour le moment. Ajoutez une publication pour commencer ðŸš€
        </div>

        <!-- Liste des posts -->
        <article
          *ngFor="let post of visiblePosts"
          class="bg-white rounded-2xl shadow-sm p-4 space-y-3"
        >
          <header class="flex items-start gap-3">
            <img
              [src]="post.authorAvatar"
              alt="avatar"
              class="w-10 h-10 rounded-full object-cover"
            />
            <div class="flex-1">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm font-semibold text-slate-800">
                    {{ post.authorName }}
                  </p>
                  <p class="text-xs text-slate-400">
                    {{ post.authorHandle }} Â· {{ post.timeAgo }}
                  </p>
                </div>
              </div>
            </div>
          </header>

          <p class="text-sm text-slate-700 whitespace-pre-line">
            {{ post.text }}
          </p>

          <div *ngIf="post.imageUrl" class="rounded-2xl overflow-hidden border border-slate-100">
            <img [src]="post.imageUrl" alt="post image" class="w-full object-cover" />
          </div>

          <!-- Actions -->
          <div class="flex items-center justify-between text-xs text-slate-500 mt-1">
            <div class="flex items-center gap-4">
              <button
                class="flex items-center gap-1"
                [ngClass]="post.likedByMe ? 'text-[#9C2C2C]' : 'text-slate-500'"
                (click)="toggleLike(post)"
              >
                <span class="material-icons text-base">J'aime</span>
                <span class="font-semibold">{{ post.likes }}</span>
              </button>

              <div class="flex items-center gap-1 text-slate-500">
                <span class="material-icons text-base">Commentaires</span>
                <span class="font-semibold">{{ post.commentsCount }}</span>
              </div>

              <button class="flex items-center gap-1 text-slate-500" (click)="sharePost(post)">
                <span class="material-icons text-base">Publier</span>
                <span class="font-semibold">{{ post.shares }}</span>
              </button>
            </div>
          </div>

          <!-- Commentaires -->
          <div class="pt-2 border-t border-slate-100 space-y-2">
            <div *ngFor="let comment of post.comments" class="flex items-start gap-2">
              <div
                class="w-7 h-7 rounded-full bg-slate-200 flex items-center justify-center text-[10px] text-slate-500"
              >
                {{ comment.author[0] | uppercase }}
              </div>
              <div class="bg-slate-50 rounded-2xl px-3 py-2 text-xs flex-1">
                <div class="flex justify-between gap-2">
                  <span class="font-semibold text-slate-700">{{ comment.author }}</span>
                  <button
                    *ngIf="comment.mine"
                    class="text-[10px] text-slate-400 hover:text-red-500"
                    (click)="deleteComment(post, comment)"
                  >
                    Supprimer
                  </button>
                </div>
                <p class="text-slate-700 mt-0.5">
                  {{ comment.text }}
                </p>
              </div>
            </div>

            <!-- Ajouter un commentaire -->
            <div class="flex items-start gap-2 mt-1">
              <div
                class="w-7 h-7 rounded-full bg-slate-300 flex items-center justify-center text-[10px] text-white"
              >
                T
              </div>
              <div class="flex-1 flex items-center gap-2">
                <input
                  type="text"
                  [(ngModel)]="newCommentText[post.id]"
                  placeholder="Ã‰crire un commentaire..."
                  class="flex-1 text-xs border border-slate-200 rounded-full px-3 py-2 outline-none focus:border-[#5b7cff] focus:ring-2 focus:ring-[#5b7cff]/10"
                />
                <button
                  type="button"
                  class="text-xs text-[#5b7cff] font-semibold"
                  (click)="addComment(post)"
                >
                  Publier
                </button>
              </div>
            </div>
          </div>
        </article>

        <!-- Loader infinite scroll -->
        <div *ngIf="isLoadingMore" class="text-center text-xs text-slate-400 py-4">
          Chargement de nouvelles publications...
        </div>

        <div *ngIf="!hasMore && visiblePosts.length > 0" class="text-center text-[11px] text-slate-400 py-4">
          Vous avez vu toutes les publications rÃ©centes.
        </div>
      </section>

      <!-- Colonne droite -->
      <aside class="hidden lg:block w-72 space-y-4">
        <div class="bg-white rounded-2xl shadow-sm overflow-hidden">
          <div class="h-16 bg-gradient-to-r from-[#5b7cff] to-[#8b5cf6]"></div>
          <div class="p-4 -mt-8 flex flex-col items-center">
            <img
              src="https://i.pravatar.cc/150?img=5"
              class="w-16 h-16 rounded-full border-4 border-white object-cover"
              alt="user"
            />
            <p class="mt-2 text-sm font-semibold text-slate-800">Marie Dubois</p>
            <p class="text-xs text-slate-400">@marie.dubois</p>

            <div class="flex justify-between w-full mt-4 text-xs text-slate-600">
              <div class="text-center flex-1">
                <div class="font-semibold">256</div>
                <div class="text-slate-400 text-[11px]">AbonnÃ©s</div>
              </div>
              <div class="text-center flex-1">
                <div class="font-semibold">189</div>
                <div class="text-slate-400 text-[11px]">Abonnements</div>
              </div>
            </div>
          </div>
        </div>

        <div class="bg-white rounded-2xl shadow-sm p-4 text-sm">
          <h3 class="font-semibold text-slate-800 mb-3">Raccourcis</h3>
          <ul class="space-y-2 text-slate-600 text-xs">
            <li class="flex items-center gap-2 cursor-pointer hover:text-[#5b7cff]">
              <span class="material-icons text-base">group</span>
              Mes groupes
            </li>
            <li class="flex items-center gap-2 cursor-pointer hover:text-[#5b7cff]">
              <span class="material-icons text-base">event</span>
              Ã‰vÃ©nements
            </li>
            <li class="flex items-center gap-2 cursor-pointer hover:text-[#5b7cff]">
              <span class="material-icons text-base">bookmark_border</span>
              Publications enregistrÃ©es
            </li>
            <li class="flex items-center gap-2 cursor-pointer hover:text-[#5b7cff]">
              <span class="material-icons text-base">trending_up</span>
              Tendances
            </li>
          </ul>
        </div>

        <!-- Tendance  -->
        <!-- <div class="bg-white rounded-2xl shadow-sm p-4 text-sm">
          <h3 class="font-semibold text-slate-800 mb-3">Sujets tendances</h3>
          <ul class="space-y-2 text-xs">
            <li class="flex justify-between">
              <a href="#" class="text-[#5b7cff] hover:underline">#TechNews</a>
              <span class="text-slate-400">895k</span>
            </li>
            <li class="flex justify-between">
              <a href="#" class="text-[#5b7cff] hover:underline">#WebDev</a>
              <span class="text-slate-400">902k</span>
            </li>
            <li class="flex justify-between">
              <a href="#" class="text-[#5b7cff] hover:underline">#DesignInspiration</a>
              <span class="text-slate-400">100k</span>
            </li>
            <li class="flex justify-between">
              <a href="#" class="text-[#5b7cff] hover:underline">#Startup</a>
              <span class="text-slate-400">612k</span>
            </li>
          </ul>
        </div> -->
      </aside>
    </div>
  </main>
</div>
