<div
  class="relative min-h-screen bg-[#f5f7fa] flex items-center justify-center p-5 overflow-hidden"
>
  <!-- halos -->
  <div
    class="pointer-events-none absolute -top-[200px] -left-[200px] w-[500px] h-[500px] rounded-full"
    style="background: radial-gradient(circle, rgba(91,124,255,0.08) 0%, transparent 70%);"
  ></div>
  <div
    class="pointer-events-none absolute -bottom-[150px] -right-[150px] w-[400px] h-[400px] rounded-full"
    style="background: radial-gradient(circle, rgba(139,92,246,0.08) 0%, transparent 70%);"
  ></div>

  <div
    class="relative z-10 flex w-full max-w-5xl min-h-[600px] bg-white rounded-[30px] shadow-2xl gap-5"
  >
    <!-- GAUCHE -->
    <div
      class="flex-1 flex items-center justify-center bg-gradient-to-br from-[#5b7cff] to-[#8b5cf6] rounded-[30px] m-5 px-10 py-16 relative overflow-hidden"
    >
      <div class="w-full max-w-md text-white space-y-8">
        <div>
          <h2 class="text-3xl font-bold lowercase mb-2">loominetfy</h2>
          <p class="text-sm leading-relaxed text-white/85">
            Connectez-vous avec vos amis et le monde qui vous entoure sur loominetfy.
          </p>
        </div>

        <div class="space-y-4">
          <div class="flex items-start gap-3">
            <div
              class="w-10 h-10 rounded-xl bg-white/15 flex items-center justify-center backdrop-blur"
            >
              <span class="text-lg">üîê</span>
            </div>
            <div>
              <h3 class="text-sm font-semibold">Compte s√©curis√©</h3>
              <p class="text-xs text-white/85">
                R√©initialisez votre mot de passe en toute s√©curit√©.
              </p>
            </div>
          </div>

          <div class="flex items-start gap-3">
            <div
              class="w-10 h-10 rounded-xl bg-white/15 flex items-center justify-center backdrop-blur"
            >
              <span class="text-lg">üì©</span>
            </div>
            <div>
              <h3 class="text-sm font-semibold">Par email ou SMS</h3>
              <p class="text-xs text-white/85">
                Choisissez le moyen qui vous convient le mieux.
              </p>
            </div>
          </div>

          <div class="flex items-start gap-3">
            <div
              class="w-10 h-10 rounded-xl bg-white/15 flex items-center justify-center backdrop-blur"
            >
              <span class="text-lg">‚ö°</span>
            </div>
            <div>
              <h3 class="text-sm font-semibold">Rapide et simple</h3>
              <p class="text-xs text-white/85">
                Quelques √©tapes suffisent pour retrouver l‚Äôacc√®s.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- DROIT -->
    <div
      class="flex-1 flex flex-col justify-center bg-white rounded-[30px] my-5 mr-5 px-10 py-10"
    >
      <div class="mb-5">
        <h1
          class="text-3xl font-bold bg-gradient-to-r from-[#5b7cff] to-[#8b5cf6] bg-clip-text text-transparent mb-1"
        >
          R√©initialiser votre mot de passe
        </h1>
        <p class="text-sm text-slate-500">
          Suivez les √©tapes pour cr√©er un nouveau mot de passe.
        </p>
      </div>

      <!-- Steps -->
      <div class="flex items-center gap-2 mb-4 text-xs text-slate-500">
        <span
          class="w-2 h-2 rounded-full"
          [ngClass]="currentStep === 1 ? 'bg-[#5b7cff]' : 'bg-slate-300'"
        ></span>
        <span
          class="w-2 h-2 rounded-full"
          [ngClass]="currentStep === 2 ? 'bg-[#5b7cff]' : 'bg-slate-300'"
        ></span>
        <span
          class="w-2 h-2 rounded-full"
          [ngClass]="currentStep === 3 ? 'bg-[#5b7cff]' : 'bg-slate-300'"
        ></span>
        <span>√âtape {{ currentStep }} sur 3</span>
      </div>

      <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" class="flex flex-col gap-5">
        <!-- ETAPE 1 : choix + envoi du code -->
        <ng-container *ngIf="currentStep === 1">
          <div>
            <label class="block text-xs font-medium text-slate-800 mb-1">
              Comment souhaitez-vous recevoir le code ?
            </label>
            <div class="flex gap-2 mb-1">
              <label
                class="flex-1 flex items-center gap-2 rounded-xl border-2 px-3 py-2 cursor-pointer text-xs transition"
                [ngClass]="
                  methodControl.value === 'email'
                    ? 'border-[#5b7cff] bg-[#5b7cff]/10 text-slate-800'
                    : 'border-slate-200 text-slate-500'
                "
              >
                <input type="radio" formControlName="method" class="hidden" value="email" />
                <span
                  class="inline-flex items-center justify-center w-4 h-4 rounded-full border border-slate-300"
                >
                  <span
                    *ngIf="methodControl.value === 'email'"
                    class="w-2 h-2 rounded-full bg-[#5b7cff]"
                  ></span>
                </span>
                <span>Email</span>
              </label>

              <label
                class="flex-1 flex items-center gap-2 rounded-xl border-2 px-3 py-2 cursor-pointer text-xs transition"
                [ngClass]="
                  methodControl.value === 'sms'
                    ? 'border-[#5b7cff] bg-[#5b7cff]/10 text-slate-800'
                    : 'border-slate-200 text-slate-500'
                "
              >
                <input type="radio" formControlName="method" class="hidden" value="sms" />
                <span
                  class="inline-flex items-center justify-center w-4 h-4 rounded-full border border-slate-300"
                >
                  <span
                    *ngIf="methodControl.value === 'sms'"
                    class="w-2 h-2 rounded-full bg-[#5b7cff]"
                  ></span>
                </span>
                <span>SMS</span>
              </label>
            </div>
            <p class="text-[11px] text-slate-500">
              Nous vous enverrons un code de v√©rification unique.
            </p>
          </div>

          <div *ngIf="methodControl.value === 'email'">
            <label class="block text-xs font-medium text-slate-800 mb-1">Adresse email</label>
            <input
              type="email"
              formControlName="email"
              placeholder="votre@email.com"
              class="w-full rounded-xl border-2 border-slate-200 px-4 py-3 text-sm outline-none transition focus:border-[#5b7cff] focus:ring-4 focus:ring-[#5b7cff]/10"
            />
            <span class="block mt-1 text-xs text-red-600 min-h-[1rem]">
              {{ errors['email'] }}
            </span>
          </div>

          <div *ngIf="methodControl.value === 'sms'">
            <label class="block text-xs font-medium text-slate-800 mb-1"
              >Num√©ro de t√©l√©phone</label
            >
            <input
              type="tel"
              formControlName="phone"
              placeholder="+33 6 12 34 56 78"
              class="w-full rounded-xl border-2 border-slate-200 px-4 py-3 text-sm outline-none transition focus:border-[#5b7cff] focus:ring-4 focus:ring-[#5b7cff]/10"
            />
            <span class="block mt-1 text-xs text-red-600 min-h-[1rem]">
              {{ errors['phone'] }}
            </span>
          </div>

          <button
            type="button"
            (click)="sendCode()"
            class="rounded-xl bg-gradient-to-r from-[#5b7cff] to-[#8b5cf6] px-4 py-3 text-sm font-semibold text-white shadow-md hover:shadow-lg hover:-translate-y-[1px] transition"
          >
            Envoyer le code
          </button>
        </ng-container>

        <!-- ETAPE 2 : saisie + v√©rification du code -->
        <ng-container *ngIf="currentStep === 2">
          <div>
            <label class="block text-xs font-medium text-slate-800 mb-1"
              >Code de v√©rification</label
            >
            <input
              type="text"
              maxlength="6"
              formControlName="code"
              placeholder="Entrez le code re√ßu"
              class="w-full rounded-xl border-2 border-slate-200 px-4 py-3 text-sm outline-none transition focus:border-[#5b7cff] focus:ring-4 focus:ring-[#5b7cff]/10"
            />
            <span class="block mt-1 text-xs text-red-600 min-h-[1rem]">
              {{ errors['code'] }}
            </span>
            <p class="text-[11px] text-slate-500">Le code est valable pendant 10 minutes.</p>
          </div>

          <div class="flex gap-3">
            <button
              type="button"
              (click)="backToStep1()"
              class="flex-1 rounded-xl bg-slate-100 px-4 py-3 text-sm font-semibold text-slate-700 hover:bg-slate-200 transition"
            >
              Retour
            </button>
            <button
              type="button"
              (click)="verifyCode()"
              class="flex-1 rounded-xl bg-gradient-to-r from-[#5b7cff] to-[#8b5cf6] px-4 py-3 text-sm font-semibold text-white shadow-md hover:shadow-lg hover:-translate-y-[1px] transition"
            >
              V√©rifier le code
            </button>
          </div>
        </ng-container>

        <!-- ETAPE 3 : nouveau mot de passe -->
        <ng-container *ngIf="currentStep === 3">
          <div>
            <label class="block text-xs font-medium text-slate-800 mb-1"
              >Nouveau mot de passe</label
            >
            <input
              type="password"
              formControlName="newPassword"
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              class="w-full rounded-xl border-2 border-slate-200 px-4 py-3 text-sm outline-none transition focus:border-[#5b7cff] focus:ring-4 focus:ring-[#5b7cff]/10"
            />
            <span class="block mt-1 text-xs text-red-600 min-h-[1rem]">
              {{ errors['newPassword'] }}
            </span>
            <p class="text-[11px] text-slate-500 mt-1">
              Min. 8 caract√®res, 1 majuscule, 1 chiffre, 1 caract√®re sp√©cial.
            </p>
          </div>

          <div>
            <label class="block text-xs font-medium text-slate-800 mb-1"
              >Confirmer le nouveau mot de passe</label
            >
            <input
              type="password"
              formControlName="confirmPassword"
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              class="w-full rounded-xl border-2 border-slate-200 px-4 py-3 text-sm outline-none transition focus:border-[#5b7cff] focus:ring-4 focus:ring-[#5b7cff]/10"
            />
            <span class="block mt-1 text-xs text-red-600 min-h-[1rem]">
              {{ errors['confirmPassword'] }}
            </span>
          </div>

          <div class="flex gap-3">
            <button
              type="button"
              (click)="backToStep2()"
              class="flex-1 rounded-xl bg-slate-100 px-4 py-3 text-sm font-semibold text-slate-700 hover:bg-slate-200 transition"
            >
              Retour
            </button>
            <button
              type="submit"
              class="flex-1 rounded-xl bg-gradient-to-r from-[#5b7cff] to-[#8b5cf6] px-4 py-3 text-sm font-semibold text-white shadow-md hover:shadow-lg hover:-translate-y-[1px] transition"
            >
              R√©initialiser le mot de passe
            </button>
          </div>

          <div *ngIf="success" class="text-sm text-green-600 mt-2">
            Votre mot de passe a √©t√© r√©initialis√© avec succ√®s.
          </div>
        </ng-container>
      </form>

      <p class="mt-6 text-xs text-slate-500">
        Vous vous souvenez de votre mot de passe ?
        <a routerLink="/login" class="text-[#5b7cff] hover:text-[#8b5cf6] hover:underline">
          Retour √† la connexion
        </a>
      </p>
    </div>
  </div>
</div>
